<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            background-color: #E4E9F3;
        }
        * {
            box-sizing: border-box;
        }
        form {
            display: flex;
            flex-direction: column;
            max-width: 300px;
            margin: 1em auto;
            padding: 1em;
            font-family: Arial, Helvetica, sans-serif;
        }

        .ibj-frm-prods__sel {
            position:relative;
            max-height: 90vh;
            margin-bottom: 8px;
        }
        .ibj-frm-prods__sel a,
        .ibj-frm-prods__sel a:active,
        .ibj-frm-prods__sel a:link,
        .ibj-frm-prods__sel a:visited,
        .ibj-frm-prods__sel a:hover,
        .ibj-frm-prods__sel a:target
        {
            text-decoration: none;
            color: #000f6c;
        }

        .ibj-frm-prods__opts-open-btn {
            padding: 8px;
            display: flex;
            position: relative;
            align-items: center;
            justify-content: space-between;
            font-size: 16px;
            line-height: 1em;
            color: #fff;
            background-color: #3794db;
            border-radius: 4px;
            box-shadow: 0 0px 8px rgba(0 0 0 /25%);
        }
        .ibj-frm-prods__sel a.ibj-frm-prods__opts-open-btn:active,
        .ibj-frm-prods__sel a.ibj-frm-prods__opts-open-btn:link,
        .ibj-frm-prods__sel a.ibj-frm-prods__opts-open-btn:visited,
        .ibj-frm-prods__sel a.ibj-frm-prods__opts-open-btn:hover,
        .ibj-frm-prods__sel a.ibj-frm-prods__opts-open-btn:target{
            color: #fff;
        }
        .ibj-frm-prods__sel a.ibj-frm-prods__opts-open-btn:hover{
            background-color: #48A5EA;
        }

        .ibj-frm-prods__opts-open-btn::after {
            display: block;
            content: "▾";
            font-size: 18px;
            line-height: 16px;
            height: 16px;
            width: 16px;
            text-align: center;
        }
        .ibj-frm-prods__opts-popup {
            position: absolute;
            z-index: 999;
            width: 100%;
            margin-top: 8px;
        }

        .ibj-frm-prods__opts-close-btn {
            display: none;
            height: 54px;
            position: absolute;
            width: 100%;
            top: -54px;
        }
        .ibj-frm-prods__opts-popup:target .ibj-frm-prods__opts-close-btn {
            display: block;
        }

        .ibj-frm-prods__opts-border {
            width: 100%;
            height: 0;
            transition: height 200ms ease-in-out;
            overflow: hidden;
            border-radius: 4px;
            box-shadow: 0 0px 8px rgba(0 0 0 /45%);
        }
        .ibj-frm-prods__opts-popup:target .ibj-frm-prods__opts-border {
            max-height: 50vh;
            height: auto;
        }

        .ibj-frm-prods__opts {
            overflow: auto;
            overflow-x: hidden;
            max-height: 50vh;
            width: 100%;
        }
        .ibj-frm-prods__opt {
            display: grid;
            grid-template-columns:45% auto;
            grid-template-rows: 17px 17px;
            background-color: #fff;
        }
        .ibj-frm-prods__opt:nth-of-type(odd) {
            background-color:#E4E9F3;
        }
        .ibj-frm-prods__opt-model {
            font-weight: bold;
            font-size:22px;
            grid-column: 1/2;
            grid-row: 1/3;
            align-self: center;
            padding-left: 4px;
        }
        .ibj-frm-prods__opt-pump {
            font-size: 12px;
            grid-column: 2/3;
            grid-row: 1/2;
            align-self: end;
        }
        .ibj-frm-prods__opt-pipe {
            font-size: 12px;
            grid-column: 2/3;
            grid-row: 2/3;
            align-self: start;
        }

        /* Selected Opts */

        .ibj-frm-prods__quote {
            position: relative;
            max-width: 100%;
        }
        .ibj-frm-prods__quote-input {
            width: 100%;
            border: none;
            background-color: #fff;
            border-radius: 4px;
            border:none;
        }
    </style>

</head>
<body>
    <p>
        Lorem ipsum, dolor sit amet consectetur adipisicing elit. Laborum amet similique, sunt quaerat voluptas enim quos! Ab recusandae eveniet dolores minus et quam fugiat, repellat quo architecto delectus, similique inventore.
    </p>
<form action="">
    <script type="text/template" id="ibj-frm-prods__opt-template">
        <a class="ibj-frm-prods__opt" data-idx="{{idx}}" href="#ibj-frm-prods__opts-open-btn">
            <span class="ibj-frm-prods__opt-model">{{model}}</span>
            <span class="ibj-frm-prods__opt-pump">{{pump}}</span>
            <span class="ibj-frm-prods__opt-pipe">{{pipe}}</span>
        </a>
    </script>

    <div class="ibj-frm-prods__sel">
        <a class="ibj-frm-prods__opts-open-btn" id="ibj-frm-prods__opts-open-btn" href="#ibj-frm-prods__opts-popup">Selecionar e incluir um modelo na lista...</a>
        <div class="ibj-frm-prods__opts-popup" id="ibj-frm-prods__opts-popup">
            <a class="ibj-frm-prods__opts-close-btn" href="#ibj-frm-prods__opts-open-btn"></a>
            <div class="ibj-frm-prods__opts-border">
                <div class="ibj-frm-prods__opts"></div>
            </div>
        </div>
    </div>

    <div class="ibj-frm-prods__quote">
        <script type="text/template" id="ibj-frm-prods__quote-item-template">
            <li class="ibj-frm-prods__quote-item" data-idx="{{idx}}">
                <span class="ibj-frm-prods__quote-item-model">{{model}}</span>
                <span class="ibj-frm-prods__quote-item-pump">{{pump}}</span>
                <span class="ibj-frm-prods__quote-item-pipe">{{pipe}}</span>
                <input class="ibj-frm-prods__quote-item-qty" type="number" min="1" value="{{qty}}"/>
                <span class="ibj-frm-prods__quote-item-del-btn">x</span>
            </li>
        </script>
        <ul class="ibj-frm-prods__quote-list"></ul>

        <script type="text/template" id="ibj-frm-prods__quote-th-template">
            <table border="0" cellspacing="0" cellpadding="6" >
                <tr>
                    <td><h4 style="margin:0;padding: 0;">MODELO</h4></td>
                    <td><h4 style="margin:0;padding: 0;">QUANTIDADE</h4></td>
                </tr>
                <tr><td colspan="2" style="padding:0;"><hr noshade="noshade" size="1" style="margin: 0;"></td></tr>
        </script>
        <script type="text/template" id="ibj-frm-prods__quote-tr-template">
            <tr>
                <td>
                    <big style="font-size: 1.4em;">PLUS-14</big>
                    <div style="padding-left: 1.5em ;font-size:0.8em">
                        <div>P-15/3-K   6,0 cv</div>
                        <div>SUC 1½”   REC 1½”</div>
                    </div>
                </td>
                <td style="font-size:2em;text-align: center;">1</td>
            </tr>
            <tr><td colspan="2" style="padding:0;"><hr noshade="noshade" size="1" style="margin: 0;"></td></tr>
        </script>
        <script type="text/template" id="ibj-frm-prods__quote-tf-template">
            </table>
        </script>
        <textarea name="" id="" cols="30" rows="10" class="ibj-frm-prods__quote-input">
        </textarea>
    </div>

</form>

<script>
    window.addEventListener("load", function() {
        (function (){
            var productsArray=[
                ['KA-1',    'THS-18     3.0 cv',    'SUC 2”    REC 1½”'  ],
                ['KA-2',    'THS-18     4.0 cv',    'SUC 2”    REC 1½”'  ],
                ['KA-3',    'THS-18     5.0 cv',    'SUC 2”    REC 1½”'  ],
                ['KA-4',    'THS-18     6.0 cv',    'SUC 2”    REC 1½”'  ],
                ['KA-5',    'THS-18     7.5 cv',    'SUC 2”    REC 1½”'  ],
                ['KA-6',    'THS-18    10.0 cv',    'SUC 2”    REC 1½”'  ],
                ['KA-7',    'THS-18    12.5 cv',    'SUC 2”    REC 1½”'  ],
                ['KA-8',    'THB-18    10.0 cv',    'SUC 3”    REC 2½”'  ],
                ['KA-9',    'THB-18    12.5 cv',    'SUC 3”    REC 2½”'  ],
                ['KA-10',   'THB-18    15.0 cv',    'SUC 3”    REC 2½”'  ],
                ['KA-11',   'THB-18    20.0 cv',    'SUC 3”    REC 2½”'  ],
                ['KA-26',   'TH-18      3,0 cv',    'SUC 2”    REC 2½”'  ],
                ['KA-27',   'THS-18     5,0 cv',    'SUC 2”    REC 2½”'  ],
                ['KA-28',   'THS-18     7,5 cv',    'SUC 2”    REC 2½”'  ],
                ['KA-29',   'THS-18    10,0 cv',    'SUC 2”    REC 2½”'  ],
                ['KR-1',    'B-12-NR    0,5 cv',    'SUC ¾”    REC ¾”'   ],
                ['KR-2',    'TH-16-NR   1,0 cv',    'SUC 1”    REC 1”'   ],
                ['KR-3',    'TH-16-NR   1,5 cv',    'SUC 1¼”   REC 1”'   ],
                ['KR-4',    'TH-16-NR   2,0 cv',    'SUC 1¼”   REC 1”'   ],
                ['KR-5',    'TH-16-NR   3,0 cv',    'SUC 1¼”   REC 1”'   ],
                ['KR-6',    'THS-18-R   5,0 cv',    'SUC 2”    REC 1½”'  ],
                ['KR-7',    'THS-18-R   7,5 cv',    'SUC 2”    REC 1½”'  ],
                ['KR-8',    'THS-18-R  10,0 cv',    'SUC 2”    REC 1½”'  ],
                ['PLUS-1',  'P-11/2     1,0 cv',    'SUC 1”    REC 1”'   ],
                ['PLUS-2',  'P-11/3     1,5 cv',    'SUC 1”    REC 1”'   ],
                ['PLUS-3',  'P-11/3     2,0 cv',    'SUC 1”    REC 1”'   ],
                ['PLUS-4',  'P-11/4     3,0 cv',    'SUC 1”    REC 1”'   ],
                ['PLUS-11', 'P-15/2-F   3,0 cv',    'SUC 1½”   REC 1½”'  ],
                ['PLUS-12', 'P-15/2-K   4,0 cv',    'SUC 1½”   REC 1½”'  ],
                ['PLUS-13', 'P-15/2-N   5,0 cv',    'SUC 1½”   REC 1½”'  ],
                ['PLUS-14', 'P-15/3-K   6,0 cv',    'SUC 1½”   REC 1½”'  ],
            ]

            var htmlProductsQuoteInput  = document.getElementsByClassName('ibj-frm-prods__quote-input')[0]
            var htmlProductsOpts        = document.getElementsByClassName('ibj-frm-prods__opts')[0]
            var optTemplate             = document.getElementById("ibj-frm-prods__opt-template").innerText
            var quoteItemTemplate       = document.getElementById("ibj-frm-prods__quote-item-template").innerText
            var htmlProductsQuoteList   = document.getElementsByClassName('ibj-frm-prods__quote-list')[0]

            var quoteItemsQuantityArray = []

            function productsModelSelectAddOpts(){
                var bufferOpts = ''
                var bufferOpt = ''
                for(var i=0; i < productsArray.length; i++){
                    bufferOpt = optTemplate
                        .replace('{{idx}}', i)
                        .replace('{{model}}', productsArray[i][0])
                        .replace('{{pump}}', productsArray[i][1])
                        .replace('{{pipe}}', productsArray[i][2])
                    bufferOpts += bufferOpt
                }
                htmlProductsOpts.innerHTML = bufferOpts
            }

            function quoteAddItem(itemIndex){
                if (quoteItemsQuantityArray[itemIndex] > 0){
                    quoteItemsQuantityArray[itemIndex]++ // console.log('Item já existe')
                }
                else {
                    quoteItemsQuantityArray[itemIndex]=1 // console.log('Item não existe')
                }
                quoteListUpdate(quoteItemsQuantityArray, productsArray)
            }

            function quoteListUpdate(quoteItemsQuantityArray){
                var bufferQuoteList = ''
                var bufferQuoteItem = ''
                for (var i=0; i < quoteItemsQuantityArray.length; i++){
                    if (quoteItemsQuantityArray[i] > 0) {
                        bufferQuoteItem = quoteItemTemplate
                        .replace('{{idx}}', i)
                        .replace('{{model}}', productsArray[i][0])
                        .replace('{{pump}}', productsArray[i][1])
                        .replace('{{pipe}}', productsArray[i][2])
                        .replace('{{qty}}', quoteItemsQuantityArray[i])
                        bufferQuoteList += bufferQuoteItem
                    }
                }
                htmlProductsQuoteList.innerHTML = bufferQuoteList
            }

            htmlProductsOpts.addEventListener("click", function(event){
                var idx = event.target.dataset.idx
                if (!idx){
                    idx = event.target.parentElement.dataset.idx
                }
                quoteAddItem(idx)
            })

            productsModelSelectAddOpts()
        })()
    });
    </script>




<table border="0" cellspacing="0" cellpadding="6" >
    <tr>
        <td><b>MODELO</b></td>
        <td><b>QUANTIDADE</b></td>
    </tr>
    <tr><td colspan="2" style="padding:0;"><hr noshade="noshade" size="1" style="margin: 0;"></td></tr>
    <tr>
        <td>
            <big style="font-size: 1.4em;">PLUS-14</big>
            <div style="padding-left: 1.5em ;font-size:0.8em">
                <div>P-15/3-K   6,0 cv</div>
                <div>SUC 1½”   REC 1½”</div>
            </div>
        </td>
        <td style="font-size:2em;text-align: center;">1</td>
    </tr>
    <tr><td colspan="2" style="padding:0;"><hr noshade="noshade" size="1" style="margin: 0;"></td></tr>
</table>

</body>
</html>